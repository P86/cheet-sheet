## Data structure in MongoDB

- Database
  - Collections (like tables in SQL)
    - Documents (like datapiecies or rows in SQL)

All those structures are created implicitly (automatically) when you start work with them. So no prior schema definition is needed.

All commands in this document refers to mongodb shell `mongosh`. Syntax for diver in particular programming language may be different but usually keeep the convention.

Documents are in fact JSON documents. So any valid JSON can be inserted into collection. Under the hood MongoDB keeps it in BSON format, but this is technical details that user dont have to care of.

Mongo DB also adds some special types to document like autogenerated id for each document. It is like `ObjectId('...')`, you can add your own id for document. When inserting document add `_id` key to document (underscore is required).

The quotation marks around keys in JSON documents can be ommited as long as it does not contains space.

Documents in the same collection don't have to have same schema.

### Filters

Filter in examples below is JSON object that allows to specify object to find, update or delete. So for example there can be an object

```JSON
{"name":"John", "age":30, "car":null}
```

So filter, in case you need to find "John" will be

```JSON
{"name": "John"}
```

If you want match all documents in collection use empty filter `{}`

Filters albo can be conditional. For example you want to find documents where `age` is greater than `25`. Then filter will looks like `{age: {$gt: 25}}`

### List databases

```
show dbs
```

### Switch to database (database does not have to exist)

```
use <database name>
```

To refer to current database use `db`

### Use collection

```
db.<collection>
```

### Insert document into collection

```
db.<collection>.insertOne({...})
```

### Insert many documents into collection (it accepts array as an argument)

```
db.<collection>.insertMany([...])
```

### Get all documents in collection

```
db.<collection>.find(<filter>, <options>)
```

### Get single document from collection

```
db.<collection>.findOne(<filter>, <options>)
```

### Update document

```
db.<collection>.updateOne(<filter>, <data>, <options>)
```

Document update require to use special convenction to instruct MongoDB how exactly update data.
So If you want set field in document the `data` param must contain special operator `$set` that will contain document to update.

```
db.<collection>.updateOne(<filter>, {$set: {<key>: <value>}})
```

### Update many documents

```
db.<collection>.updateMany(<filter>, <data>, <options>)
```

### Replace document

```
db.<collection>.replaceOne(<filter>, <data>, <options>)
```

### Delete document

```
db.<collection>.deleteOne(<filter>, <options>)
```

### Delete many documents

```
db.<collection>.deleteMany(<filter>, <options>)
```
